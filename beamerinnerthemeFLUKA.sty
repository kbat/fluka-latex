\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{beamerinnerthemeFLUKA}[2024/02/01 v1.0.0 The FLUKA Beamer Theme]
\mode<presentation>{%
  % title page
  %% definitions for fonts of the different elements
  \setbeamerfont{institute}{family=\comicneue, size = \large}
  \setbeamerfont{title}{family=\comicneue, series=\bfseries, size = \Huge}
  \setbeamerfont{subtitle}{family=\comicneue, size = \large}
  \setbeamerfont{date}{family=\comicneue, series=\bfseries, size = \large}
  \setbeamerfont{author}{family=\comicneue, size = \large}

  \setbeamertemplate{title page}{%
    \begin{minipage}[c][\textheight][c]{\textwidth}
      \vspace*{\baselineskip}
      \hspace{-0.5cm}\includegraphics[height=0.2\textheight]{figs/fluka-logo.png} \hfill  \includegraphics[height=0.2\textheight]{figs/lanzhou.pdf}

      \vfill

      %          {\usebeamerfont{institute}\insertinstitute}\vspace*{30pt}

      \begin{center}
        {\usebeamerfont{title}\usebeamercolor[fg]{title}\inserttitle}
      \end{center}

      \vfill

      \begin{flushright}
        {\usebeamerfont{subtitle}\usebeamercolor[fg]{subtitle}\insertsubtitle} \\ \vspace{0.5\baselineskip}
        {\usebeamerfont{date}\usebeamercolor[fg]{subtitle}\insertdate}%
        \vspace*{\baselineskip}
      \end{flushright}

%      \vspace*{30pt}

%          {\usebeamerfont{author}\insertauthor}\vspace*{30pt}

    \end{minipage}
  }
  \addtobeamertemplate{title page}{
    \begin{tikzpicture}[remember picture,overlay]
      \node[above right,inner sep=0pt] at (current page.south west)
           {
             \includegraphics[width=\paperwidth]{figs/background.jpg}
             \tikz[overlay] \fill[fill opacity=0.75,fill=white] (0,0) rectangle (-\paperwidth,\paperheight);
           };
    \end{tikzpicture}
  }{}

  \defbeamertemplate{final page}{text}[1]{%
    \begin{minipage}[c][\textheight][c]{\textwidth}
      \begin{center}
        {\usebeamerfont{title}\usebeamercolor[fg]{title}#1}
      \end{center}
    \end{minipage}
  }

  \NewCommandCopy{\oldhref}{\href}
  \RenewDocumentCommand\href{mm}{
    \oldhref{#1}{{\usebeamercolor[bg]{FLUKA}#2}}
  }

  \NewDocumentCommand\finalpage{}{%
    \begin{frame}[plain,noframenumbering]
      \setbeamertemplate{final page}[text]{\oldhref{http://www.fluka.org}{www.fluka.org}}
      \usebeamertemplate{final page}
    \end{frame}
  }

  \setbeamertemplate{bibliography item}[text]
  \setbeamertemplate{items}[square]
  \setbeamertemplate{sections/subsections in toc}[square]
}


\mode<all>
